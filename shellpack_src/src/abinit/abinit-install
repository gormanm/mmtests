#!/bin/bash
###SHELLPACK preamble abinit-install 10.4.7
WEB_LOCATION="https://forge.abinit.org/"
GIT_LOCATION="https://github.com/abinit/abinit/"
MIRROR_LOCATION="$WEBROOT/abinit"

if [ "$ABINIT_OPENMPI_VERSION" != "" ]; then
	###SHELLPACK mpi_setup_deps ABINIT_OPENMPI_VERSION
	###SHELLPACK mpi_setup_env ABINIT_OPENMPI_VERSION ABINIT_MPI_PATH ABINIT_MPI_LIBPATH
	ABINIT_MPI_ROOT=`which mpicc | sed -e 's/bin\/mpicc//'`
fi
install-depends gcc-fortran gcc
install-depends hdf5 hdf5-devel
install-depends hdf5-$ABINIT_OPENMPI_VERSION
install-depends libxc12 libxc12 libxc-devel
install-depends netcdf netcdf-devel netcdf-$ABINIT_OPENMPI_VERSION
install-depends netcdf-fortran netcdf-fortran-devel netcdf-fortran-$ABINIT_OPENMPI_VERSION

###SHELLPACK parseargBegin
###SHELLPACK parseargEnd

rm -rf $SHELLPACK_SOURCES/abinit-${VERSION}
###SHELLPACK sources_fetch abinit-${VERSION}.tar.gz abinit-${VERSION}
###SHELLPACK build_start abinit-${VERSION}

DEPSROOT="$SHELLPACK_SOURCES/abinitdeps-installed"
# SHELLPACK build_configure abinit-${VERSION}-installed --enable-openmp --with-fft-flavor=goedecker  --with-libxc=\"$DEPSROOT\"
###SHELLPACK build_configure abinit-${VERSION}-installed --enable-openmp --with-fft-flavor=goedecker --without-netcdf --without-netcdf-fortran

###SHELLPACK make
rm -rf $SHELLPACK_SOURCES/abinit-${VERSION}-installed
mv $SHELLPACK_SOURCES/abinit-${VERSION} $SHELLPACK_SOURCES/abinit-${VERSION}-installed

echo abinit installed successfully
exit $SHELLPACK_SUCCESS


